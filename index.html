<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
  <meta name="color-scheme" content="dark only"/>
  <title>Utby Snabb Bilverkstad — Pålitlig bilservice i Göteborg</title>
  <meta name="description" content="Utby Snabb Bilverkstad i Göteborg: service, diagnos, bromsar, däck, AC och kompletta reparationer. Drop-in, vardagar 09:00–18:00, däckhotell."/>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&family=Space+Grotesk:wght@700&display=swap" rel="stylesheet">
  <style>
    *,*::before,*::after{box-sizing:border-box}
    html,body{margin:0;padding:0;height:100%;background:#0b0c10;color:#f6f7fb;font-family:Inter,system-ui,Segoe UI,Roboto,Arial}
    html,body{overflow-x:hidden}
    img{max-width:100%;display:block}
    a{color:#DABD66;text-decoration:none}
    .container{width:min(1100px,100%);margin:auto;padding:0 18px}

    /* Header */
    .header{position:sticky;top:0;z-index:10;background:rgba(12,13,18,.7);backdrop-filter:blur(10px);border-bottom:1px solid rgba(255,255,255,.1)}
    .header-inner{display:flex;justify-content:space-between;align-items:center;padding:10px 0}
    .brand{display:flex;align-items:center;gap:10px}
    .brand img{width:64px;height:64px;border-radius:12px;object-fit:contain;filter:drop-shadow(0 0 12px rgba(218,189,102,.3))}
    .brand-name{font:800 18px/1 Space Grotesk;color:#fff}
    .nav{display:flex;gap:8px}
    .nav a{display:flex;align-items:center;gap:8px;padding:8px 12px;border-radius:999px;font-weight:700;font-size:14px;border:1px solid rgba(255,255,255,.12);line-height:1}
    .nav a.secondary{background:rgba(255,255,255,.06);color:#fff}
    .nav a:not(.secondary){background:#DABD66;color:#111}
    .nav a .icon svg{width:16px;height:16px}

    /* Hero */
    .hero{text-align:center;padding:30px 0}
    h1{font-family:Space Grotesk,Inter;font-weight:800;font-size:clamp(26px,6vw,40px);background:linear-gradient(90deg,#fff,#DABD66);-webkit-background-clip:text;color:transparent;margin:.3em 0}
    .lead{color:#C9D2DE;max-width:65ch;margin:0 auto 16px}
    .cta{display:flex;justify-content:center;gap:10px;flex-wrap:wrap}
    .btn{padding:9px 14px;border-radius:12px;font-weight:800;font-size:14px;border:1px solid rgba(255,255,255,.1);transition:.2s}
    .btn.primary{background:#DABD66;color:#111}
    .btn.ghost{background:rgba(255,255,255,.06);color:#fff}
    .btn:hover{transform:translateY(-2px)}
    .hero-logo{width:min(300px,60vw);margin:20px auto 0;filter:drop-shadow(0 10px 30px rgba(218,189,102,.35))}

    /* Sections */
    .section{padding:35px 0}
    .section h2{text-align:center;font:800 22px/1.3 Space Grotesk;margin:0 0 10px}
    .section p.muted{text-align:center;color:#C9D2DE;margin:0 0 18px}

    /* Services */
    .services{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:14px}
    .card{background:rgba(255,255,255,.04);border:1px solid rgba(255,255,255,.1);border-radius:14px;padding:14px}
    .card h3{margin:.1em 0 .2em;font:700 17px/1.2 Inter}
    .card p{margin:0 0 6px}
    .card img{width:100%;height:140px;object-fit:cover;border-radius:10px;margin-top:8px}

    /* Booking & Contact Forms */
    .booking,.contact-form{display:grid;gap:10px;max-width:560px;margin:20px auto}
    .booking label,.contact-form label{font-weight:600;font-size:13px;color:#e6e8ef}
    .booking input,.booking select,.booking textarea,.contact-form input,.contact-form textarea{
      width:100%;height:42px;padding:8px 10px;border-radius:8px;
      border:1px solid rgba(255,255,255,.12);background:rgba(255,255,255,.05);
      color:#fff;font-size:14px
    }
    .booking textarea,.contact-form textarea{height:auto;min-height:100px;resize:vertical}
    .booking input:focus,.booking select:focus,.booking textarea:focus,.contact-form input:focus,.contact-form textarea:focus{
      border-color:#d9b954;outline:none;box-shadow:0 0 0 2px rgba(218,189,102,.25)
    }
    .booking button,.contact-form button{margin-top:6px;padding:12px 14px;border-radius:999px;background:linear-gradient(180deg,#e9cf6e,#d4b848);color:#111;font-weight:800;font-size:15px;border:none;cursor:pointer;box-shadow:0 4px 16px rgba(218,189,102,.25)}
    .booking button[disabled],.contact-form button[disabled]{opacity:.6;cursor:not-allowed}
    .booking button:hover,.contact-form button:hover{transform:translateY(-2px);box-shadow:0 6px 20px rgba(218,189,102,.35)}
    
    /* Contact Form Specific */
    .contact-form{padding:20px;background:rgba(255,255,255,.04);border:1px solid rgba(255,255,255,.1);border-radius:14px}
    .contact-form h3{text-align:center;font:800 20px/1.3 Space Grotesk;margin:0 0 15px;color:#fff}
    #contactStatus{margin-top:10px;padding:10px;border-radius:8px;text-align:center;display:none}
    #contactStatus.success{background:rgba(34,197,94,.1);color:#4ade80;border:1px solid rgba(34,197,94,.3)}
    #contactStatus.error{background:rgba(239,68,68,.1);color:#f87171;border:1px solid rgba(239,68,68,.3)}

    /* Fix native select menu colors */
    .booking select{background:#121317;color:#fff}
    .booking select option{background:#0b0c10;color:#fff}
    .booking select option[disabled]{color:#9fb0c0}

    /* Map */
    .map-container{text-align:center;margin-top:22px}
    iframe{width:100%;height:240px;border:0;border-radius:12px}

    /* Footer */
    .site-footer{margin-top:32px;background:linear-gradient(180deg,rgba(255,255,255,.03),rgba(255,255,255,.015));border-top:1px solid rgba(255,255,255,.12)}
    .footer-top{display:grid;grid-template-columns:1.2fr 1fr 1fr;gap:16px;padding:22px 0 12px}
    .site-footer h4{font:800 16px/1.2 Inter;color:#fff;margin:.2em 0 .5em}
    .site-footer p,.site-footer a,.site-footer li{color:#C9D2DE;font-size:14px;line-height:1.6}
    .site-footer a:hover{color:#DABD66}
    .footer-divider{height:2px;background:linear-gradient(90deg,transparent,rgba(218,189,102,.7),transparent);margin:8px 0 12px}
    .copyright-bar{text-align:center;padding:10px 0 16px;font-size:13px;color:#BFC7D4;border-top:1px solid rgba(255,255,255,.08)}
    .copyright-bar a{color:#DABD66;font-weight:700}
    .copyright-bar a:hover{color:#fff}

    /* Modal */
    .modal{position:fixed;inset:0;display:none;place-items:center;z-index:20;background:rgba(8,10,14,.55);backdrop-filter:blur(14px)}
    .modal.show{display:grid}
    .modal-card{width:min(620px,92vw);background:linear-gradient(180deg,rgba(255,255,255,.07),rgba(255,255,255,.03));border:1px solid rgba(255,255,255,.14);border-radius:18px;padding:18px;box-shadow:0 32px 90px rgba(0,0,0,.52)}
    .modal-header{display:flex;align-items:center;gap:10px;justify-content:flex-start;margin-bottom:12px}
    .modal-header img{width:40px;height:40px;border-radius:10px;object-fit:contain;filter:drop-shadow(0 6px 18px rgba(218,189,102,.35))}
    .modal-card h3{font:800 20px/1.2 Inter;margin:.1em 0;text-align:left}
    .modal-card p{color:#C9D2DE;margin:4px 0 10px;text-align:left}
    .action{display:block;width:100%;text-align:center;font-weight:900;border-radius:12px;padding:12px;margin:10px 0}
    .action.call{background:#111;color:#DABD66;border:1px solid rgba(255,255,255,.08)}
    .action.mail{background:linear-gradient(180deg,#e9cf6e,#d4b848);color:#111;border:none}
    .modal .meta{color:#D7DEEA;font-size:14px;margin-top:10px}
    .modal .meta strong{color:#fff}
    .modal-close{display:block;margin:14px auto 2px;text-align:center;color:#9fb0c0;cursor:pointer}

    /* lock scroll when modal open */
    body.scroll-lock{overflow:hidden}

    /* SMS FAB draggable */
    .sms-fab{
      position:fixed;right:14px;bottom:14px;width:54px;height:54px;border-radius:50%;
      display:flex;align-items:center;justify-content:center;background:linear-gradient(180deg,#e9cf6e,#d4b848);color:#111;
      border:1px solid rgba(0,0,0,.2);text-decoration:none;transition:.15s;box-shadow:none !important;touch-action:none;
      z-index:100
    }
    .sms-fab svg{width:24px;height:24px}

    @media(max-width:520px){
      .footer-top{grid-template-columns:1fr}
      .brand img{width:54px;height:54px}
      .nav{flex-wrap:wrap}
    }

    /* datum & tid side-by-side small */
    .inline-dt{display:grid;grid-template-columns:repeat(2,minmax(140px,1fr));gap:8px;align-items:end;margin-top:4px}
    .inline-dt .field{display:flex;flex-direction:column;gap:4px}
    .inline-dt label{font-size:12px}
    .inline-dt input{height:32px;font-size:12px;padding:6px 8px;max-width:100%}
    @media(max-width:520px){.inline-dt{grid-template-columns:1fr}}
  </style>
</head>
<body>

  <!-- Header -->
  <header class="header">
    <div class="container header-inner">
      <a class="brand" href="#start"><img src="assets/logo.png" alt="logo"/><span class="brand-name">Utby Snabb Bilverkstad</span></a>
      <nav class="nav">
        <a class="secondary" href="#tjanster">
          <span class="icon"><svg viewBox="0 0 24 24" fill="currentColor"><path d="M22.7 19.3l-6.4-6.4a6 6 0 01-7.6-7.6l3.1 3.1 2.1-.7.7-2.1-3.1-3.1a6 6 0 007.6 7.6l6.4 6.4-2.8 2.8zM4 20a2 2 0 110-4 2 2 0 010 4z"/></svg></span>
          <span>Tjänster</span>
        </a>
        <a class="secondary" href="#kontakt">
          <span class="icon"><svg viewBox="0 0 24 24" fill="currentColor"><path d="M6.6 10.8a15.1 15.1 0 006.6 6.6l2.2-2.2a1 1 0 011-.24 11.6 11.6 0 003.6.57 1 1 0 011 1V20a1 1 0 01-1 1A17 17 0 013 4a1 1 0 011-1h3.5a1 1 0 011 1 11.6 11.6 0 00.57 3.6 1 1 0 01-.24 1l-2.23 2.2z"/></svg></span>
          <span>Kontakt</span>
        </a>
        <a href="#boka">
          <span class="icon"><svg viewBox="0 0 24 24" fill="currentColor"><path d="M7 2h2v2h6V2h2v2h3a2 2 0 012 2v12a2 2 0 01-2 2H4a2 2 0 01-2-2V6a2 2 0 012-2h3V2z"/></svg></span>
          <span>Boka tid</span>
        </a>
      </nav>
    </div>
  </header>

  <!-- Hero -->
  <section class="hero" id="start">
    <div class="container">
      <h1>Professionell bilservice i Göteborg</h1>
      <p class="lead">Komplett service، reparation och diagnos för alla bilmärken. Drop-in välkommen — vardagar 09:00–18:00. Vi erbjuder däckhotell och full bilservice.</p>
      <div class="cta">
        <a class="btn primary" href="#boka">Boka tid</a>
        <a class="btn ghost" href="tel:+46720040936">Ring 072-004 09 36</a>
      </div>
      <img class="hero-logo" src="assets/logo.png" alt="Utby Snabb Bilverkstad logotyp">
    </div>
  </section>

  <!-- Tjänster -->
  <section class="section" id="tjanster">
    <div class="container">
      <h2>Våra tjänster</h2>
      <p class="muted">Vi hanterar allt från motor och växellåda till minsta komponent. Du får alltid prisförslag innan åtgärd och tydlig återkoppling när arbetet är klart.</p>

      <div class="services">
        <div class="card">
          <h3>Service</h3>
          <p>Planerad service enligt tillverkarens intervall: byte av motorolja och filter، kontroll av vätskor، bromsar، batteri، belysning och drivlina.</p>
          <ul style="margin:6px 0 8px 18px">
            <li>30–40 punkters säkerhetskontroll</li>
            <li>Provkörning och felkodsavläsning</li>
            <li>Serviceunderlag & tydlig återkoppling</li>
          </ul>
          <img src="assets/photo1.jpg" alt="Service och oljebyte">
        </div>

        <div class="card">
          <h3>Däck & hjul</h3>
          <p>Skifte sommar/vinter، balansering och kontroll av mönsterdjup och lufttryck. Vi programmerar och kalibrerar även TPMS vid behov.</p>
          <ul style="margin:6px 0 8px 18px">
            <li>Däckhotell: torrt، säkert och försäkrat</li>
            <li>Snabbt skifte med momentkontroll</li>
            <li>Rådgivning om rätt dimension och lastindex</li>
          </ul>
          <img src="assets/photo3.jpg" alt="Däckhotell och hjulservice">
        </div>

        <div class="card">
          <h3>Kompletta reparationer</h3>
          <p>Från bromsar، avgassystem och fjädring till motor، koppling/växellåda och el. Vi felsöker systematiskt med moderna diagnosverktyg.</p>
          <ul style="margin:6px 0 8px 18px">
            <li>Kamrem/kedja، vattenpump och packningar</li>
            <li>Bromsskivor/-belägg، ok & handbroms</li>
            <li>AC-service: läcktest & påfyllning</li>
          </ul>
          <img src="assets/photo2.jpg" alt="Kompletta reparationer">
        </div>
      </div>

      <div class="card" style="margin-top:14px">
        <h3>Vanliga frågor (FAQ)</h3>
        <p><strong>Behöver jag boka tid?</strong> Drop-in vardagar 09:00–18:00. För större jobb rekommenderar vi bokning.</p>
        <p><strong>Uppdaterar ni servicehistorik?</strong> Ja، där digital bok finns uppdaterar vi den. Annars får du underlag/stämpel.</p>
        <p><strong>Vilka delar använder ni?</strong> Original eller OEM-kvalitet enligt tillverkarens specifikationer.</p>
        <p><strong>Garanti på arbete?</strong> Ja، vi lämnar garanti på både delar och arbete enligt branschpraxis.</p>
      </div>
    </div>
  </section>

 <!-- Kontakt & Bokning — Ren & Modern version -->
<!-- Kontakt & Bokning (Förbättrad) -->
<section class="section booking-section" id="boka" aria-labelledby="boka-heading">
  <div class="container">
    <h2 id="boka-heading">Kontakt & bokning</h2>

    <div class="grid">
      <!-- Kontakt / Form -->
      <div class="card contact-card" aria-labelledby="contact-heading">
        <h3 id="contact-heading">Kontakta oss direkt</h3>

        <form id="contactForm" action="https://formsubmit.co/snabbservise@hotmail.com" method="POST" novalidate>
          <!-- FormSubmit inställningar -->
          <input type="hidden" name="_template" value="table">
          <input type="hidden" name="_subject" value="Nytt meddelande — Utby Snabb Bilverkstad">
          <input type="hidden" name="_captcha" value="false">
          <input type="text" name="_honey" style="display:none">

          <div class="form-row">
            <label for="contactName">Namn *</label>
            <input id="contactName" name="name" type="text" placeholder="Ditt fullständiga namn" required>
          </div>

          <div class="form-row">
            <label for="contactEmail">E-post *</label>
            <input id="contactEmail" name="email" type="email" placeholder="din@epost.se" required>
          </div>

          <div class="form-row three-cols">
            <div>
              <label for="contactPhone">Telefon *</label>
              <input id="contactPhone" name="phone" type="tel" placeholder="072-123 45 67" required>
            </div>

            <div>
              <label for="contactCar">Bil / Regnr *</label>
              <input id="contactCar" name="car" placeholder="Ex: ABC123 eller Volvo V60 2017" required>
            </div>

            <div>
              <label for="contactService">Problem / Tjänst *</label>
              <select id="contactService" name="service" required>
                <option value="" disabled selected>Välj ett alternativ…</option>
                <option>Service & olja</option>
                <option>Bromsar</option>
                <option>Däck & hjul</option>
                <option>AC / klimatanläggning</option>
                <option>El / elektronik</option>
                <option>Diagnos / OBD</option>
                <option>Växellåda / koppling</option>
                <option>Motor</option>
                <option>Annan åtgärd</option>
                <option>Förfrågan om pris</option>
                <option>Allmän fråga</option>
              </select>
            </div>
          </div>

          <div class="form-row">
            <label for="contactMessage">Meddelande *</label>
            <textarea id="contactMessage" name="message" placeholder="Berätta vad du behöver hjälp med..." required></textarea>
          </div>

          <div class="form-divider">Bokningsförslag</div>

          <div class="form-row two-cols">
            <div>
              <label for="bookingDate">Datum *</label>
              <input id="bookingDate" name="booking_date" type="date" required>
            </div>

            <div>
              <label for="bookingTime">Tid *</label>
              <select id="bookingTime" name="booking_time" required>
                <option value="" disabled selected>Välj datum först…</option>
              </select>
            </div>
          </div>

          <div class="form-row checkbox-row">
            <input id="contactConsent" name="consent" type="checkbox" required>
            <label for="contactConsent" class="inline">Jag godkänner att mina uppgifter används för bokning och kontakt.</label>
          </div>

          <div class="form-actions">
            <button type="submit" id="submitBtn">Skicka meddelande</button>
            <div id="contactStatus" role="status" aria-live="polite"></div>
          </div>
        </form>
      </div>

      <!-- Info / Öppettider (Kompletterande kort) -->
      <aside class="card info-card" aria-labelledby="info-heading">
        <h4 id="info-heading">Öppettider & snabbinfo</h4>
        <p><strong>Adress:</strong> Utby Snabb Bilverkstad</p>
        <p><strong>Telefon:</strong> 072-123 45 67</p>
        <p><strong>Öppettider:</strong></p>
        <ul>
          <li>Mån–Fre: 08:00 – 17:00</li>
          <li>Lör: 09:00 – 13:00</li>
          <li>Sön: Stängt</li>
        </ul>

        <div class="times-note">
          <p><strong>Tidsluckor:</strong> Morgon, eftermiddag och kväll. Om ingen tid passar — ange förslag i meddelandet så återkommer vi.</p>
        </div>
      </aside>
    </div>
  </div>
</section>

<!-- STYLES -->
<style>
  :root{
    --bg: #f7f9fb;
    --card: #ffffff;
    --accent: #1f6feb;
    --muted: #6b7280;
    --radius: 10px;
    font-family: Inter, "Segoe UI", Roboto, system-ui, -apple-system, "Helvetica Neue", Arial;
  }

  .booking-section{ padding: 40px 16px; background: var(--bg); color:#0b1220; }
  .booking-section .container{ max-width:1100px; margin:0 auto; }
  .booking-section h2{ margin:0 0 20px; font-size:1.7rem; }
  .grid{ display:grid; grid-template-columns: 1fr 320px; gap:20px; align-items:start; }
  @media (max-width:900px){ .grid{grid-template-columns:1fr;} }

  .card{ background:var(--card); border-radius:var(--radius); box-shadow: 0 6px 20px rgba(11,17,32,0.06); padding:20px; }
  .contact-card h3{ margin-top:0; margin-bottom:12px; }
  .info-card h4{ margin-top:0; }

  .form-row{ margin-bottom:14px; display:block; }
  .form-row label{ display:block; margin-bottom:6px; font-size:0.92rem; color:var(--muted); }
  input[type="text"], input[type="email"], input[type="tel"], input[type="date"], select, textarea {
    width:100%; padding:10px 12px; border-radius:8px; border:1px solid #e6e9ef; box-sizing:border-box;
    font-size:0.95rem; background:#fff;
  }
  textarea{ min-height:110px; resize:vertical; }

  .three-cols{ display:grid; grid-template-columns: 1fr 1fr 1fr; gap:12px; }
  .two-cols{ display:grid; grid-template-columns: 1fr 1fr; gap:12px; }
  @media (max-width:700px){ .three-cols, .two-cols{ grid-template-columns:1fr; } }

  .form-divider{ margin:16px 0; font-weight:600; color:var(--muted); font-size:0.95rem; }

  .checkbox-row{ display:flex; gap:8px; align-items:center; font-size:0.9rem; color:var(--muted); }
  .checkbox-row input{ width:18px; height:18px; }

  .form-actions{ display:flex; gap:12px; align-items:center; margin-top:6px; }
  button[type="submit"]{
    background:var(--accent); color:white; padding:10px 16px; border-radius:8px; border:none; cursor:pointer; font-weight:600;
  }
  button[type="submit"]:hover{ filter:brightness(0.95); }

  #contactStatus{ font-size:0.95rem; color:var(--muted); }

  .info-card ul{ padding-left:18px; margin:6px 0 12px; color:var(--muted); }
  .times-note{ font-size:0.9rem; color:var(--muted); margin-top:12px; }
</style>

<!-- SCRIPTS -->
<script>
  (function(){
    const bookingDate = document.getElementById('bookingDate');
    const bookingTime = document.getElementById('bookingTime');
    const contactForm = document.getElementById('contactForm');
    const statusEl = document.getElementById('contactStatus');
    const submitBtn = document.getElementById('submitBtn');

    // Föreslagna tidsluckor - kan justeras
    const timePools = {
      morning: ["08:00","08:30","09:00","09:30","10:00","10:30","11:00"],
      afternoon: ["12:00","12:30","13:00","13:30","14:00","14:30","15:00","15:30","16:00"],
      evening: ["16:30","17:00"]
    };

    // Sätt min datum till idag
    function setMinDate(){
      const today = new Date();
      const yyyy = today.getFullYear();
      const mm = String(today.getMonth() + 1).padStart(2,'0');
      const dd = String(today.getDate()).padStart(2,'0');
      bookingDate.min = `${yyyy}-${mm}-${dd}`;
      bookingDate.value = `${yyyy}-${mm}-${dd}`;
      populateTimes(); // initiera tider för dagens datum
    }

    // Fyll tidsval beroende på valt datum
    function populateTimes(){
      bookingTime.innerHTML = '';
      const selected = bookingDate.value;
      if(!selected){
        bookingTime.innerHTML = '<option value="" disabled selected>Välj datum först…</option>';
        return;
      }

      // Logik: om bokar idag, ta bort tidsluckor som redan passerat
      const today = new Date();
      const chosen = new Date(selected + 'T00:00:00');
      const isToday = (today.getFullYear() === chosen.getFullYear()
                      && today.getMonth() === chosen.getMonth()
                      && today.getDate() === chosen.getDate());

      const createOptGroup = (label, times) => {
        const optGroup = document.createElement('optgroup');
        optGroup.label = label;
        times.forEach(t => {
          // Om dagens datum, filtrera bort tider tidigare än nu
          if(isToday){
            const [hh,mm] = t.split(':').map(Number);
            const nowMinutes = today.getHours()*60 + today.getMinutes();
            const tMinutes = hh*60 + mm;
            if(tMinutes <= nowMinutes + 29) return; // uteslut tider som redan börjat eller inom 30 min
          }
          const opt = document.createElement('option');
          opt.value = t;
          opt.textContent = t;
          optGroup.appendChild(opt);
        });
        return optGroup;
      };

      // Lägg till grupper i önskad ordning
      const morningGroup = createOptGroup('Morgon', timePools.morning);
      const afternoonGroup = createOptGroup('Eftermiddag', timePools.afternoon);
      const eveningGroup = createOptGroup('Kväll', timePools.evening);

      // Bygg lista och hantera fall när inga tider kvar
      const groups = [morningGroup, afternoonGroup, eveningGroup].filter(g => g && g.children.length > 0);
      if(groups.length === 0){
        bookingTime.innerHTML = '<option value="" disabled>Inga lediga tider detta datum — välj ett annat datum eller skriv förslag i meddelandet</option>';
        bookingTime.disabled = true;
      } else {
        bookingTime.disabled = false;
        bookingTime.innerHTML = '<option value="" disabled selected>Välj tid…</option>';
        groups.forEach(g => bookingTime.appendChild(g));
      }
    }

    // Init
    setMinDate();

    // Event listeners
    bookingDate.addEventListener('change', populateTimes);

    // Enkel klient-validering + statusvisning
    contactForm.addEventListener('submit', function(e){
      // Vidarebefordra fortfarande till FormSubmit (standard submit)
      // Men vi lägger till enkel visuell feedback här.
      if(!contactForm.checkValidity()){
        e.preventDefault();
        contactForm.reportValidity();
        return;
      }

      // Om tidfält är disabled eller inte valt -> varna användaren
      if(bookingTime.disabled || !bookingTime.value){
        e.preventDefault();
        statusEl.textContent = 'Vänligen välj en ledig tid eller ange ett förslag i meddelandet.';
        statusEl.style.color = '#b45309'; // orange
        return;
      }

      // Visuell "skickar..." state
      submitBtn.disabled = true;
      submitBtn.textContent = 'Skickar…';
      statusEl.textContent = 'Skickar meddelandet — vänta ett ögonblick...';
      statusEl.style.color = '#374151';

      // Låt standard submit ske (skickas till FormSubmit). Eftersom vi inte fångar ajax-respons,
      // återställ knapp efter kort tid så användaren kan se bekräftelse från FormSubmit (om redirect).
      setTimeout(() => {
        submitBtn.disabled = false;
        submitBtn.textContent = 'Skicka meddelande';
      }, 2500);
      // Notera: FormSubmit kan göra en redirect eller visa sin egen bekräftelse.
      // Om du vill hantera svaret AJAX-mässigt, säg till så kan jag byta formuläret till fetch()/AJAX.
    });

    // Förbättring - om användaren öppnar formuläret på en dag där alla tider för dagen gått, välj nästa dag automatiskt
    window.addEventListener('focus', () => {
      // Smått förbättringsförsök: om tidlista är tom så flytta datum framåt en dag och repopulera
      if(bookingTime && bookingTime.disabled){
        const current = new Date(bookingDate.value);
        current.setDate(current.getDate() + 1);
        const y = current.getFullYear();
        const m = String(current.getMonth()+1).padStart(2,'0');
        const d = String(current.getDate()).padStart(2,'0');
        bookingDate.value = `${y}-${m}-${d}`;
        populateTimes();
      }
    });

  })();
</script>   <!-- small send icon -->
            <svg width="16" height="16" viewBox="0 0 24 24" aria-hidden><path fill="currentColor" d="M2 21l21-9L2 3v7l15 2-15 2z"/></svg>
            Skicka / Boka
          </button>
          <div id="contactStatus" class="status" aria-live="polite"></div>
        </div>
      </form>

      <div class="map-container" id="kontakt">
        <h3>Här hittar du oss</h3>
        <p>Vagnmakaregatan 2, 415 72 Göteborg</p>
        <iframe src="https://www.google.com/maps?q=57.74025,12.07864&hl=sv&z=15&output=embed" loading="lazy" referrerpolicy="no-referrer"></iframe>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer class="site-footer">
    <div class="container footer-top">
      <div>
        <h4>Kontakt</h4>
        <p><strong>Utby Snabb Bilverkstad</strong></p>
        <p>Vagnmakaregatan 2, 415 72 Göteborg</p>
        <p>Telefon: <a href="tel:+46720040936">072-004 09 36</a></p>
        <p>E-post: <a href="mailto:info@utbysnabbbilservice.se">info@utbysnabbbilservice.se</a></p>
      </div>
      <div>
        <h4>Öppettider</h4>
        <ul>
          <li><strong>Vardagar:</strong> 09:00 – 18:00</li>
          <li>Lördag: enligt överenskommelse</li>
        </ul>
        <p style="margin-top:6px">Drop-in välkommen · <strong>Däckhotell</strong></p>
      </div>
      <div>
        <h4>Om verkstaden</h4>
        <ul>
          <li>Service, diagnos, bromsar, däck, AC och el</li>
          <li>Kompletta reparationer — motor & växellåda</li>
          <li>Tydliga besked och arbete som håller över tid</li>
        </ul>
        <p style="margin-top:6px"><a href="https://maps.google.com/?q=57.74025,12.07864" target="_blank" rel="noopener">Hitta oss på Google Maps</a></p>
      </div>
    </div>

    <div class="footer-divider"></div>

    <div class="container copyright-bar">
      <span>© 2023 Utby Snabb Bilverkstad</span> |
      <span>Design by <a href="#" id="openCreator">Hussein</a></span>
    </div>
  </footer>

  <!-- Modal: Kontakta Hussein -->
  <div class="modal" id="creatorModal">
    <div class="modal-card">
      <div class="modal-header">
        <img src="assets/logo.png" alt="Logotyp">
        <div>
          <h3>Kontakta Hussein</h3>
          <p>Via denna hemsida kan du nå mig direkt — via e-post eller mobil. Jag återkommer så snart som möjligt.</p>
        </div>
      </div>
      <a class="action call" href="tel:+46790574975">Ring: 0790574975</a>
      <a class="action mail" href="mailto:hussein@example.com">Skicka e-post</a>
      <div class="meta">
        <strong>Vill du ha en professionell hemsida?</strong>
        <p>Jag bygger snabba، säkra och mobilanpassade webbplatser för företag och privatpersoner. Från idé till färdig sida — enkelt، tydligt och snyggt.</p>
      </div>
      <span class="modal-close" id="closeCreator">Stäng</span>
    </div>
  </div>

  <!-- Modal: Tack -->
  <div class="modal" id="thanksModal">
    <div class="modal-card">
      <div class="modal-header">
        <img src="assets/logo.png" alt="Logotyp">
        <div>
          <h3>Tack!</h3>
          <p>Din förfrågan har skickats. Vi återkommer så snart som möjligt.</p>
        </div>
      </div>
      <span class="modal-close" id="thanksClose">Stäng</span>
    </div>
  </div>

  <!-- Modal: Kontaktväljare (SMS eller E-post) -->
  <div class="modal" id="chooserModal">
    <div class="modal-card">
      <div class="modal-header">
        <img src="assets/logo.png" alt="Logotyp">
        <div>
          <h3>Välj kontaktmetod</h3>
          <p>Vill du skicka SMS eller E-post?</p>
        </div>
      </div>
      <a class="action call" id="chooserSms" href="#">Skicka SMS</a>
      <a class="action mail" id="chooserMail" href="mailto:info@utbysnabbbilservice.se?subject=Bokningsförfrågan">Skicka e-post</a>
      <span class="modal-close" id="chooserClose">Stäng</span>
    </div>
  </div>

  <!-- SMS floating button -->
  <a id="smsFab" class="sms-fab" href="#" aria-label="Skicka SMS eller e-post">
    <svg viewBox="0 0 24 24" fill="currentColor">
      <path d="M20 2H4a2 2 0 00-2 2v16l4-4h14a2 2 0 002-2V4a2 2 0 01-2-2zM6 9h8v2H6V9zm0-4h12v2H6V5z"/>
    </svg>
  </a>

  <script>
    // تهيئة التاريخ
    document.addEventListener('DOMContentLoaded', function() {
      const dateInput = document.getElementById('date');
      if (dateInput) {
        const today = new Date();
        const y = today.getFullYear();
        const m = String(today.getMonth() + 1).padStart(2, '0');
        const d = String(today.getDate()).padStart(2, '0');
        dateInput.min = `${y}-${m}-${d}`;
      }

      // تهيئة وضع زر SMS
      initSmsFab();
    });

    // إدارة Modal Hussein
    const creatorModal = document.getElementById('creatorModal');
    const openCreator = document.getElementById('openCreator');
    const closeCreator = document.getElementById('closeCreator');

    if (openCreator && creatorModal) {
      openCreator.addEventListener('click', function(e) {
        e.preventDefault();
        creatorModal.classList.add('show');
        document.body.classList.add('scroll-lock');
      });
    }

    if (closeCreator && creatorModal) {
      closeCreator.addEventListener('click', function(e) {
        e.preventDefault();
        creatorModal.classList.remove('show');
        document.body.classList.remove('scroll-lock');
      });
    }

    // إغلاق Modal بالنقر خارج المحتوى
    if (creatorModal) {
      creatorModal.addEventListener('click', function(e) {
        if (e.target === creatorModal) {
          creatorModal.classList.remove('show');
          document.body.classList.remove('scroll-lock');
        }
      });
    }

    // إرسال نموذج الاتصال
    const contactForm = document.getElementById('contactForm');
    const contactStatus = document.getElementById('contactStatus');

    if (contactForm) {
      contactForm.addEventListener('submit', async function(e) {
        e.preventDefault();
        
        const submitBtn = contactForm.querySelector('button[type="submit"]');
        const originalText = submitBtn.textContent;
        
        // تعطيل الزر وعرض التحميل
        submitBtn.disabled = true;
        submitBtn.textContent = 'Skickar...';
        contactStatus.style.display = 'none';
        
        try {
          const formData = new FormData(contactForm);
          
          const response = await fetch(contactForm.action, {
            method: 'POST',
            headers: { 'Accept': 'application/json' },
            body: formData
          });
          
          if (response.ok) {
            // نجاح
            contactStatus.textContent = 'Tack! Ditt meddelande har skickats. Vi återkommer så snart som möjligt.';
            contactStatus.className = 'success';
            contactStatus.style.display = 'block';
            contactForm.reset();
          } else {
            throw new Error('Något gick fel');
          }
        } catch (error) {
          // خطأ
          contactStatus.textContent = 'Något gick fel. Vänligen försök igen eller ring oss direkt.';
          contactStatus.className = 'error';
          contactStatus.style.display = 'block';
        } finally {
          // إعادة تمكين الزر
          submitBtn.disabled = false;
          submitBtn.textContent = originalText;
        }
      });
    }

    // إرسال نموذج الحجز
    const bookingForm = document.getElementById('bookingForm');
    const thanksModal = document.getElementById('thanksModal');
    const thanksClose = document.getElementById('thanksClose');

    if (bookingForm) {
      bookingForm.addEventListener('submit', function(e) {
        e.preventDefault();
        
        if (!bookingForm.checkValidity()) {
          bookingForm.reportValidity();
          return;
        }

        const submitBtn = document.getElementById('submitBtn');
        const originalText = submitBtn.textContent;
        
        // تعطيل الزر وعرض التحميل
        submitBtn.disabled = true;
        submitBtn.textContent = 'Skickar...';
        
        // محاكاة الإرسال
        setTimeout(() => {
          // عرض رسالة النجاح
          thanksModal.classList.add('show');
          document.body.classList.add('scroll-lock');
          
          // إعادة تعيين النموذج
          bookingForm.reset();
          
          // إعادة تمكين الزر
          submitBtn.disabled = false;
          submitBtn.textContent = originalText;
        }, 1500);
      });
    }

    // إغلاق modal الشكر
    if (thanksClose && thanksModal) {
      thanksClose.addEventListener('click', function(e) {
        e.preventDefault();
        thanksModal.classList.remove('show');
        document.body.classList.remove('scroll-lock');
      });
      
      thanksModal.addEventListener('click', function(e) {
        if (e.target === thanksModal) {
          thanksModal.classList.remove('show');
          document.body.classList.remove('scroll-lock');
        }
      });
    }

    // إدارة زر SMS مع اختيار الطريقة
    function initSmsFab() {
      const smsFab = document.getElementById('smsFab');
      const chooserModal = document.getElementById('chooserModal');
      const chooserSms = document.getElementById('chooserSms');
      const chooserMail = document.getElementById('chooserMail');
      const chooserClose = document.getElementById('chooserClose');

      if (!smsFab || !chooserModal) return;

      // بناء رابط SMS بناءً على النظام الأساسي
      function getSmsHref() {
        const base = 'sms:+46720040936';
        const body = encodeURIComponent('Hej! Jag behöver rådgivning om bilen.');
        const ua = navigator.userAgent.toLowerCase();
        // iOS يستخدم &body، Android والأنظمة الأخرى تستخدم ?body
        return (ua.includes('iphone') || ua.includes('ipad')) ? 
          `${base}&body=${body}` : `${base}?body=${body}`;
      }

      // فتح modal اختيار الطريقة
      function openChooser(e) {
        e.preventDefault();
        chooserModal.classList.add('show');
        document.body.classList.add('scroll-lock');
        
        // تعيين رابط SMS
        chooserSms.href = getSmsHref();
      }

      // إغلاق modal اختيار الطريقة
      function closeChooser(e) {
        e.preventDefault();
        chooserModal.classList.remove('show');
        document.body.classList.remove('scroll-lock');
      }

      // إضافة event listeners
      smsFab.addEventListener('click', openChooser);
      chooserClose.addEventListener('click', closeChooser);
      chooserModal.addEventListener('click', function(e) {
        if (e.target === chooserModal) closeChooser(e);
      });

      // جعل زر SMS قابل للسحب
      makeSmsFabDraggable(smsFab);
    }

    // جعل زر SMS قابل للسحب
    function makeSmsFabDraggable(el) {
      const MARGIN_X = 14, MARGIN_Y = 8, CLICK_TOL = 6;
      let dragging = false, startX = 0, startY = 0, startLeft = 0, startTop = 0, pointerId = null;

      // استعادة الموضع المحفوظ
      function restorePosition() {
        try {
          const saved = JSON.parse(localStorage.getItem('smsFabPosition') || 'null');
          if (saved && (saved.side === 'left' || saved.side === 'right') && Number.isFinite(saved.top)) {
            el.style.top = Math.max(MARGIN_Y, saved.top) + 'px';
            if (saved.side === 'left') {
              el.style.left = MARGIN_X + 'px';
              el.style.right = 'auto';
            } else {
              el.style.right = MARGIN_X + 'px';
              el.style.left = 'auto';
            }
          }
        } catch (_) {}
      }

      function ensureLeftTop() {
        const rect = el.getBoundingClientRect();
        el.style.left = rect.left + 'px';
        el.style.top = rect.top + 'px';
        el.style.right = 'auto';
        el.style.bottom = 'auto';
      }

      function clampTop(top) {
        const rect = el.getBoundingClientRect();
        const vh = Math.max(document.documentElement.clientHeight, window.innerHeight || 0);
        return Math.min(vh - rect.height - MARGIN_Y, Math.max(MARGIN_Y, top));
      }

      function onPointerDown(e) {
        if (pointerId !== null && e.pointerId !== pointerId) return;
        pointerId = e.pointerId;
        try { e.target.setPointerCapture(pointerId); } catch (_) {}
        dragging = true;
        startX = e.clientX;
        startY = e.clientY;
        ensureLeftTop();
        startLeft = parseFloat(el.style.left);
        startTop = parseFloat(el.style.top);
        el.style.transition = 'none';
        e.preventDefault();
      }

      function onPointerMove(e) {
        if (!dragging || e.pointerId !== pointerId) return;
        const dx = e.clientX - startX, dy = e.clientY - startY;
        el.style.left = Math.round(startLeft + dx) + 'px';
        el.style.top = Math.round(startTop + dy) + 'px';
        e.preventDefault();
      }

      function onPointerUp(e) {
        if (e.pointerId !== pointerId) return;
        try { e.target.releasePointerCapture(pointerId); } catch (_) {}
        const dx = e.clientX - startX, dy = e.clientY - startY;
        const moved = Math.hypot(dx, dy);
        dragging = false;
        pointerId = null;

        const rect = el.getBoundingClientRect();
        const vw = Math.max(document.documentElement.clientWidth, window.innerWidth || 0);
        const side = (rect.left + rect.width / 2 < vw / 2) ? 'left' : 'right';
        const top = clampTop(parseFloat(el.style.top || rect.top));
        el.style.top = Math.round(top) + 'px';

        if (side === 'left') {
          el.style.left = MARGIN_X + 'px';
          el.style.right = 'auto';
        } else {
          el.style.right = MARGIN_X + 'px';
          el.style.left = 'auto';
        }

        try {
          localStorage.setItem('smsFabPosition', JSON.stringify({ side, top }));
        } catch (_) {}

        if (moved > CLICK_TOL) {
          el.addEventListener('click', function once(ev) {
            ev.stopImmediatePropagation();
            ev.preventDefault();
          }, { once: true, capture: true });
        }
      }

      // استعادة الموضع وإضافة event listeners
      restorePosition();
      el.addEventListener('pointerdown', onPointerDown, { passive: false });
      window.addEventListener('pointermove', onPointerMove, { passive: false });
      window.addEventListener('pointerup', onPointerUp, { passive: false });
      window.addEventListener('pointercancel', onPointerUp, { passive: false });
    }
  </script>
</body>
</html>